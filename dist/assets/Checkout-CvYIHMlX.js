import{s as o,j as a}from"./index-J4kvQJuh.js";import{r as i}from"./router-DVV-WQ-W.js";import{g as p}from"./cart-CAufwINA.js";import"./react-qkC6yhPU.js";import"./pdf-KjY7QabL.js";import"./supabase-BUiByx9r.js";function w(){const r=JSON.parse(localStorage.getItem("buyNow"))||p(),[s,n]=i.useState({name:"",phone:"",house:"",city:"",state:"",pincode:""}),[c,d]=i.useState(!1);i.useEffect(()=>{l()},[]);async function l(){const{data:{user:e}}=await o.auth.getUser();if(!e)return;const{data:t}=await o.from("profiles").select("*").eq("id",e.id).single();t&&n({name:t.name||"",phone:t.phone||"",house:t.house||"",city:t.city||"",state:t.state||"",pincode:t.pincode||""})}const u=r.reduce((e,t)=>e+t.price*(t.qty||1),0);async function m(){if(r.length===0)return alert("Your cart is empty");if(!s.name||!s.phone||!s.house||!s.city||!s.state||!s.pincode)return alert("Please fill all address fields");d(!0);const{data:{user:e}}=await o.auth.getUser();if(!e)return alert("Login required");await o.from("profiles").upsert({id:e.id,...s}),localStorage.setItem("checkout_items",JSON.stringify(r)),localStorage.setItem("shipping",JSON.stringify(s)),window.location="/Payment"}return a.jsxs("div",{className:"checkout",children:[a.jsx("h2",{children:"Shipping Address"}),Object.keys(s).map(e=>a.jsx("input",{placeholder:e,value:s[e],onChange:t=>n({...s,[e]:t.target.value})},e)),a.jsx("h3",{children:"Order Summary"}),r.map(e=>a.jsxs("p",{children:[e.name," × ",e.qty||1," — ₹",e.price*(e.qty||1)]},e.id)),a.jsxs("h2",{children:["Total: ₹",u]}),a.jsx("button",{onClick:m,disabled:c,children:c?"Redirecting...":"Proceed to Payment"})]})}export{w as default};

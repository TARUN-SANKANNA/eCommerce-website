import{s as r,j as e}from"./index-J4kvQJuh.js";import{r as c}from"./router-DVV-WQ-W.js";import"./react-qkC6yhPU.js";import"./pdf-KjY7QabL.js";import"./supabase-BUiByx9r.js";function C(){const[m,p]=c.useState([]),[d,l]=c.useState(!1),[t,i]=c.useState({name:"",price:"",brand:"",type:"",category:"",gender:"",description:"",stock:"",images:[]});c.useEffect(()=>{o()},[]);async function o(){const{data:a}=await r.from("products").select("*").order("created_at",{ascending:!1});p(a||[])}function n(a){i({...t,[a.target.name]:a.target.value})}function g(a){i({...t,images:[...a.target.files]})}async function h(){if(!t.name||!t.price||!t.stock||!t.images.length){alert("Fill all required fields");return}try{l(!0);const a=[];for(let s of t.images){const u=`${Date.now()}-${s.name}`;await r.storage.from("products").upload(u,s);const{data:j}=r.storage.from("products").getPublicUrl(u);a.push(j.publicUrl)}await r.from("products").insert([{name:t.name,price:t.price,brand:t.brand,type:t.type,category:t.category,gender:t.gender,description:t.description,images:a,stock:Number(t.stock),low_stock:Number(t.stock)<=5}]),alert("Product Added"),i({name:"",price:"",brand:"",type:"",category:"",gender:"",description:"",stock:"",images:[]}),o()}catch{alert("Upload failed")}finally{l(!1)}}async function f(a){window.confirm("Delete this product?")&&(await r.from("products").delete().eq("id",a),o())}async function x(a){const s=prompt("Enter new stock quantity");s&&(await r.from("products").update({stock:s,low_stock:s<=5}).eq("id",a),o())}return e.jsxs("div",{className:"admin-page",children:[e.jsx("h2",{children:"Add New Product"}),e.jsxs("div",{className:"admin-form glass",children:[e.jsx("input",{name:"name",value:t.name,onChange:n,placeholder:"Product Name"}),e.jsx("input",{name:"price",value:t.price,onChange:n,placeholder:"Price"}),e.jsx("input",{name:"brand",value:t.brand,onChange:n,placeholder:"Brand"}),e.jsx("input",{name:"type",value:t.type,onChange:n,placeholder:"Type (T-shirt, Shoes)"}),e.jsx("input",{name:"category",value:t.category,onChange:n,placeholder:"Category"}),e.jsxs("select",{name:"gender",value:t.gender,onChange:n,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{children:"Men"}),e.jsx("option",{children:"Women"}),e.jsx("option",{children:"Unisex"})]}),e.jsx("textarea",{name:"description",value:t.description,onChange:n,placeholder:"Description"}),e.jsx("input",{name:"stock",value:t.stock,onChange:n,placeholder:"Stock",type:"number"}),e.jsx("input",{type:"file",multiple:!0,onChange:g}),e.jsx("button",{className:"glow-btn",onClick:h,disabled:d,children:d?"Uploading...":"Add Product"})]}),e.jsx("h2",{children:"All Products"}),e.jsx("div",{className:"admin-list",children:m.map(a=>e.jsxs("div",{className:"admin-card glass",children:[e.jsx("img",{src:a.images?.[0]}),e.jsx("h4",{children:a.name}),e.jsxs("p",{children:["₹",a.price]}),e.jsxs("p",{children:["Stock: ",a.stock]}),a.low_stock&&e.jsx("p",{className:"low",children:"⚠ Low stock"}),e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{onClick:()=>x(a.id),children:"Restock"}),e.jsx("button",{onClick:()=>f(a.id),className:"danger",children:"Delete"})]})]},a.id))})]})}export{C as default};

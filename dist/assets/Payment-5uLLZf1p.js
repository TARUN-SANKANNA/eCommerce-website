import{j as e,s as u}from"./index-J4kvQJuh.js";import{r as c,u as x}from"./router-DVV-WQ-W.js";import{c as j}from"./cart-CAufwINA.js";import"./react-qkC6yhPU.js";import"./pdf-KjY7QabL.js";import"./supabase-BUiByx9r.js";function I(){const[a,o]=c.useState("cod"),[l,m]=c.useState(""),[r,n]=c.useState({number:"",name:"",expiry:"",cvv:""}),d=x(),i=JSON.parse(localStorage.getItem("checkout_items"))||[],h=JSON.parse(localStorage.getItem("shipping")),p=i.reduce((t,s)=>t+s.price*(s.qty||1),0);if(i.length===0)return alert("Cart empty"),d("/"),null;async function g(){if(a==="upi"&&!l.includes("@"))return alert("Enter valid UPI");if(a==="card"&&r.number.length<16)return alert("Invalid card");const{data:{user:t}}=await u.auth.getUser(),{data:s}=await u.from("orders").insert([{user_id:t.id,items:i,total:p,status:a==="cod"?"pending":"paid",payment_method:a,shipping:h}]).select().single();localStorage.removeItem("checkout_items"),localStorage.removeItem("shipping"),localStorage.removeItem("buyNow"),j(),d("/order/"+s.id)}return e.jsxs("div",{className:"payment",children:[e.jsx("h2",{children:"Select Payment"}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",checked:a==="cod",onChange:()=>o("cod")})," COD"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",checked:a==="upi",onChange:()=>o("upi")})," UPI"]}),a==="upi"&&e.jsx("input",{placeholder:"UPI ID",value:l,onChange:t=>m(t.target.value)}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",checked:a==="card",onChange:()=>o("card")})," Card"]}),a==="card"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{placeholder:"Card Number",onChange:t=>n({...r,number:t.target.value})}),e.jsx("input",{placeholder:"Name",onChange:t=>n({...r,name:t.target.value})}),e.jsx("input",{placeholder:"MM/YY",onChange:t=>n({...r,expiry:t.target.value})}),e.jsx("input",{placeholder:"CVV",onChange:t=>n({...r,cvv:t.target.value})})]}),e.jsxs("h3",{children:["Total: â‚¹",p]}),e.jsx("button",{onClick:g,children:"Pay & Place Order"})]})}export{I as default};

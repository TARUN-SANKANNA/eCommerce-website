import{s as c,j as e}from"./index-J4kvQJuh.js";import{c as U,u as A,r as s}from"./router-DVV-WQ-W.js";import{a as B}from"./cart-CAufwINA.js";import"./react-qkC6yhPU.js";import"./pdf-KjY7QabL.js";import"./supabase-BUiByx9r.js";function Z(){const{id:n}=U(),u=A(),[i,b]=s.useState(null),[I,k]=s.useState([]),[M,O]=s.useState(5),[$,F]=s.useState(""),[C,y]=s.useState(""),[g,d]=s.useState(!1),[r,P]=s.useState(""),[q,m]=s.useState(""),[o,h]=s.useState(0),[x,E]=s.useState(0),[X,v]=s.useState(!1),[_,G]=s.useState(1);s.useEffect(()=>{L()},[n]);async function L(){const{data:t}=await c.from("products").select("*").eq("id",n).single();b(t);const{data:a}=await c.from("reviews").select("*").eq("product_id",n);k(a);const{data:{user:w}}=await c.auth.getUser();if(w){const{data:R}=await c.from("wishlist").select("*").eq("user_id",w.id).eq("product_id",n);d(R.length>0)}}if(!i)return e.jsx("p",{children:"Loading..."});const l=i.images?.length?i.images:[i.image],p=l.length,f=i.stock<=0;function j(){h((o+1)%p)}function N(){h((o-1+p)%p)}function z(t){E(t.touches[0].clientX)}function T(t){const a=t.changedTouches[0].clientX;x-a>50&&j(),a-x>50&&N()}function W(){r.length!==6?m("Enter valid pincode"):r.startsWith("5")||r.startsWith("6")?m("Delivery available"):m("Delivery not available")}async function S(t){const{data:{user:a}}=await c.auth.getUser();if(!a){alert("Please login to continue"),u("/login");return}t()}async function D(){const{data:{user:t}}=await c.auth.getUser();if(!t)return alert("Login required");g?(await c.from("wishlist").delete().eq("user_id",t.id).eq("product_id",n),d(!1)):(await c.from("wishlist").insert({user_id:t.id,product_id:n}),d(!0))}return e.jsxs("div",{className:"product-page",children:[e.jsx("button",{className:"back-btn",onClick:()=>u(-1),children:"â† Back"}),e.jsx("div",{className:"product-left",children:e.jsxs("div",{className:"image-box image-wrapper",children:[e.jsx("button",{className:"wish-btn",onClick:D,children:g?"â¤ï¸":"ðŸ¤"}),e.jsxs("div",{className:"carousel",onTouchStart:z,onTouchEnd:T,onClick:t=>{t.target.tagName==="IMG"&&v(!0)},children:[e.jsx("div",{className:"carousel-track",style:{transform:`translateX(-${o*100}%)`},children:l.map((t,a)=>e.jsx("img",{src:t,className:"carousel-img"},a))}),e.jsx("button",{className:"nav prev",onClick:t=>{t.stopPropagation(),N()},children:"â€¹"}),e.jsx("button",{className:"nav next",onClick:t=>{t.stopPropagation(),j()},children:"â€º"})]}),e.jsx("div",{className:"thumb-row",children:l.map((t,a)=>e.jsx("img",{src:t,className:o===a?"active":"",onClick:()=>h(a)},a))})]})}),X&&e.jsx("div",{className:"fullscreen",onClick:()=>v(!1),children:e.jsx("img",{src:l[o],style:{transform:`scale(${_})`}})}),e.jsxs("div",{className:"product-right",children:[e.jsx("h2",{children:i.name}),e.jsxs("div",{className:"price",children:["â‚¹",i.price]}),f&&e.jsx("p",{style:{color:"red"},children:"Out of stock"}),e.jsx("input",{value:r,onChange:t=>P(t.target.value),placeholder:"Enter pincode"}),e.jsx("button",{onClick:W,children:"Check"}),e.jsx("p",{children:q}),e.jsx("div",{className:"sizes",children:["S","M","L","XL"].map(t=>e.jsx("button",{onClick:()=>y(t),className:C===t?"active-size":"",children:t},t))}),e.jsx("button",{disabled:f,onClick:()=>S(()=>B(i)),children:"Add to Cart"}),e.jsx("button",{disabled:f,onClick:()=>S(()=>{localStorage.setItem("buyNow",JSON.stringify([i])),u("/checkout")}),children:"Buy Now"})]})]})}export{Z as default};
